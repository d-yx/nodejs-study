## 文件流

### 什么是流
* 流是指数据的流动,数据从一个地方缓缓的流动到另一个地方
* 流是有方向的
  * 可读流(Readable):数据从源头流向内存
  * 可写流(Writable):数据从内存流向源头
  * 双工流(Duplex):数据既可从源头流向内存,又可从内存流向源头
  
### 为什么需要流
* 其他介质和内存的数据规模不一致,比如：磁盘的大数据空间,而内存的小数据空间
* 其他介质和内存的数据处理能力不一致，比如：磁盘的缓慢处理数据的能力,而内存的快速处理数据的能力

### 什么是文件流
    内存数据和磁盘文件数据之间的流动

### 文件流的创建
* 创建可读流：fs.createReadStream(path[,options])
  * 含义：创建一个文件可读流,用于读取文件内容
  * path:读取文件的路径
  * options:可选配置
    * encoding:编码方式
    * start:起始字节
    * end:结束字节
    * highWaterMark:每次读取数量:如果encoding有值,就表示字符数;如果encoding为null,就表示字节数
  * 返回:Readable的子类ReadStream
* 创建可写流：fs.createWriteStream(path[,options])
  * 含义：创建一个文件可写流,用于写入文件内容
  * path:写入文件的路径
  * options:可选配置
    * encoding:编码方式
    * start:起始字节
    * end:结束字节
    * highWaterMark:每次读取数量。如果encoding有值,就表示字符数;如果encoding为null,就表示字节数
    * flags:操作文件的方式。flags:"a",表示往后写入不覆盖;flags:"w",表示覆盖文件写入。
  * 返回:Writable的子类WriteStream

### 文件流的使用
* 文件流创建后返回一个对象
  * <可读流>该对象可以注册事件:rs.on(事件名,处理函数)----注：rs为创建的可读流对象
    * open:文件打开事件,文件被打开后触发
    * error：文件出错时触发
    * close：文件被关闭时触发，可通过rs.close()手动关闭,或文件读取完毕后默认会自动关闭----注：注册了data事件后才会真正开始读取
    * data:读取到一部分数据后触发，每次读取highWaterMark指定的数量,回调函数中会附带读取到的数据(chunk)
    * end:文件读取完毕后触发
    * pause:暂停读取时触发，通过rs.pause()暂停读取
    * resume:恢复读取时触发，通过rs.resume()恢复读取
  * <可写流>该对象可以注册事件:ws.on(事件名,处理函数)----注：ws为创建的可写流对象
    * open:文件打开事件,文件被打开后触发
    * error：文件出错时触发
    * close：文件关闭时触发
    * 可写流对象的方法
      * ws.write(data)
        * 写入一组数据
        * data可以是字符串或Buffer
        * 返回一个boolean值
          * true：写入通道没有被填满，接下来的数据可以直接写入，无须排队
          * false：写入通道目前已被填满，接下来的数据将进入写入队列
        * 当写入通道清空时，会触发drain事件
      * ws.end([data])
        * 结束写入流，将自动关闭文件,是否自动关闭取决于autoClose配置,默认为true
        * data是可选的，表示关闭前的最后一次写入
  * rs.pipe(ws):将可读流连接到可写流;返回参数的值(ws);该方法可以解决背压问题 